<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FinaceDavid.Views.PayablesPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:viewmodels="clr-namespace:FinaceDavid.ViewModels"
    xmlns:domain="clr-namespace:FinaceDavid.Domain.Entities"
    BackgroundColor="{DynamicResource SurfaceColor}"
    x:DataType="viewmodels:PayablesViewModel">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Adicionar" Command="{Binding AddPayableCommand}" />
    </ContentPage.ToolbarItems>
    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">
            <Label Text="Vencidas" FontSize="18" TextColor="{DynamicResource PrimaryTextColor}" />
            <CollectionView ItemsSource="{Binding Vencidas}" SelectionMode="None">
                <CollectionView.EmptyView>
                    <Label Text="Sem contas vencidas" TextColor="{DynamicResource SecondaryTextColor}" />
                </CollectionView.EmptyView>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="domain:Payable">
                        <Border StrokeShape="RoundRectangle 18" BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="16" Margin="0,0,0,12">
                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                <Label Text="{Binding Titulo}" FontAttributes="Bold" TextColor="{DynamicResource PrimaryTextColor}" />
                                <Label Grid.Row="1" Text="{Binding Nota}" TextColor="{DynamicResource SecondaryTextColor}" />
                                <Label Grid.Column="1" Text="{Binding Valor, StringFormat='R$ {0:N2}'}" TextColor="{DynamicResource DangerColor}" />
                                <Button Grid.Column="1" Grid.Row="1" Text="Pagar" Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PayablesViewModel}}, Path=MarkAsPaidCommand}" CommandParameter="{Binding .}" BackgroundColor="{DynamicResource AccentColor}" TextColor="White" CornerRadius="12" HeightRequest="36" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <Label Text="Hoje" FontSize="18" TextColor="{DynamicResource PrimaryTextColor}" />
            <CollectionView ItemsSource="{Binding Hoje}" SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="domain:Payable">
                        <Border StrokeShape="RoundRectangle 18" BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="16" Margin="0,0,0,12">
                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                <Label Text="{Binding Titulo}" FontAttributes="Bold" TextColor="{DynamicResource PrimaryTextColor}" />
                                <Label Grid.Row="1" Text="{Binding Nota}" TextColor="{DynamicResource SecondaryTextColor}" />
                                <Label Grid.Column="1" Text="{Binding Valor, StringFormat='R$ {0:N2}'}" TextColor="{DynamicResource PrimaryTextColor}" />
                                <Button Grid.Column="1" Grid.Row="1" Text="Editar" Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PayablesViewModel}}, Path=EditPayableCommand}" CommandParameter="{Binding .}" BackgroundColor="{DynamicResource CardBorderColor}" TextColor="{DynamicResource PrimaryTextColor}" CornerRadius="12" HeightRequest="36" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <Label Text="PrÃ³ximas" FontSize="18" TextColor="{DynamicResource PrimaryTextColor}" />
            <CollectionView ItemsSource="{Binding Proximas}" SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="domain:Payable">
                        <Border StrokeShape="RoundRectangle 18" BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="16" Margin="0,0,0,12">
                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                <Label Text="{Binding Titulo}" FontAttributes="Bold" TextColor="{DynamicResource PrimaryTextColor}" />
                                <Label Grid.Row="1" Text="{Binding Nota}" TextColor="{DynamicResource SecondaryTextColor}" />
                                <Label Grid.Column="1" Text="{Binding Valor, StringFormat='R$ {0:N2}'}" TextColor="{DynamicResource PrimaryTextColor}" />
                                <Label Grid.Column="1" Grid.Row="1" Text="{Binding Vencimento, StringFormat='{0:dd/MM}'}" TextColor="{DynamicResource SecondaryTextColor}" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
